<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Golf Round Tracker</title>
  <style>
    :root{
      --bg:#f7f8fa; --panel:#ffffff; --muted:#4b5563; --text:#111827; --accent:#059669; --accent2:#2563eb; --border:#d1d5db;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans}
    .wrap{max-width:1100px;margin:40px auto;padding:0 16px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
    h1{font-size:28px;margin:0;letter-spacing:.2px}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.05);}
    .section{padding:16px}
    .grid{display:grid;gap:12px}
    .grid.cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}
    label{font-size:13px;color:var(--muted)}
    input[type="text"],input[type="number"],input[type="date"],select,textarea{width:100%;padding:8px 10px;background:#f9fafb;border:1px solid var(--border);color:var(--text);border-radius:8px;outline:none}
    textarea{min-height:38px;resize:vertical}
    .btns{display:flex;flex-wrap:wrap;gap:10px}
    button{cursor:pointer;border:1px solid var(--border);background:#f9fafb;color:var(--text);padding:8px 12px;border-radius:8px;font-weight:600}
    button.primary{background:var(--accent2);color:#fff;border:0}
    button.accent{background:var(--accent);color:#fff;border:0}
    button.ghost{background:transparent}
    table{width:100%;border-collapse:separate;border-spacing:0 6px}
    thead th{font-size:12px;color:var(--muted);text-align:left;padding:8px 10px}
    tbody tr{background:#f9fafb;border:1px solid var(--border)}
    tbody tr td{padding:0 8px}
    .hole{width:48px;text-align:center;font-weight:700;color:var(--muted)}
    .center{display:flex;align-items:center;justify-content:center}
    .totals{display:flex;gap:20px;flex-wrap:wrap;color:var(--muted)}
    .pill{padding:4px 8px;border:1px solid var(--border);border-radius:999px;background:#f9fafb}
    .json{width:100%;min-height:130px;background:#f3f4f6;border:1px dashed var(--border);border-radius:8px;padding:12px;color:#374151;white-space:pre-wrap}
    .note{font-size:12px;color:var(--muted)}
    .tag{font-size:12px;color:var(--muted)}
    .sr-only{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Golf Round Tracker</h1>
      <div class="tag" id="autosaveStatus">Auto-save: idle</div>
    </header>
    <div class="card section">
      <div class="grid cols-4">
        <div>
          <label for="date">Date</label>
          <input id="date" type="date" />
        </div>
        <div>
          <label for="course">Course</label>
          <input id="course" type="text" placeholder="e.g., Army Navy Fairfax" />
        </div>
        <div>
          <label for="tee">Tee</label>
          <input id="tee" type="text" placeholder="e.g., White" />
        </div>
        <div>
          <label for="notesRound">Round Notes</label>
          <input id="notesRound" type="text" placeholder="optional" />
        </div>
      </div>
    </div>

    <div class="card section">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Strokes</th>
            <th>Putts</th>
            <th>GIR</th>
            <th style="width:45%">Notes</th>
          </tr>
        </thead>
        <tbody id="holesBody"></tbody>
      </table>
      <div class="totals" id="totals">
        <span class="pill">Total Strokes: <strong id="tStrokes">0</strong></span>
        <span class="pill">Total Putts: <strong id="tPutts">0</strong></span>
        <span class="pill">GIR: <strong id="tGIR">0</strong>/18</span>
      </div>
      <div class="btns">
        <button class="ghost" id="clearBtn">Clear</button>
        <button class="accent" id="importBtn">Import JSON</button>
        <button class="primary" id="exportBtn">Export JSON</button>
      </div>
      <textarea id="jsonArea" class="json" spellcheck="false" aria-label="JSON output preview"></textarea>
    </div>
    <div class="note">Tip: This page auto-saves to your browser (localStorage). Host on GitHub Pages or embed in Squarespace.</div>
  </div>
  <script>
    (function(){
      const LS_KEY='golf_round_current_v1';
      const holesBody=document.getElementById('holesBody');
      const totalsEl={strokes:document.getElementById('tStrokes'),putts:document.getElementById('tPutts'),gir:document.getElementById('tGIR')};
      const dateEl=document.getElementById('date');
      const courseEl=document.getElementById('course');
      const teeEl=document.getElementById('tee');
      const notesRoundEl=document.getElementById('notesRound');
      const exportBtn=document.getElementById('exportBtn');
      const importBtn=document.getElementById('importBtn');
      const clearBtn=document.getElementById('clearBtn');
      const jsonArea=document.getElementById('jsonArea');
      const autosaveStatus=document.getElementById('autosaveStatus');
      let saveTimer;
      for(let i=1;i<=18;i++){
        const tr=document.createElement('tr');
        tr.innerHTML=`
          <td class="hole">${i}</td>
          <td><input inputmode="numeric" type="number" min="1" id="strokes-${i}"/></td>
          <td><input inputmode="numeric" type="number" min="0" id="putts-${i}"/></td>
          <td class="center"><input type="checkbox" id="gir-${i}"/></td>
          <td><textarea id="notes-${i}" placeholder="notes (optional)"></textarea></td>
        `;
        holesBody.appendChild(tr);
      }
      function numVal(sel){const v=document.querySelector(sel).value;if(v==='')return null;const n=Number(v);return Number.isFinite(n)?n:null}
      function readModel(){const holes=[];for(let i=1;i<=18;i++){holes.push({hole:i,strokes:numVal(`#strokes-${i}`),putts:numVal(`#putts-${i}`),gir:document.querySelector(`#gir-${i}`).checked,notes:document.querySelector(`#notes-${i}`).value.trim()});}return{date:dateEl.value||null,course:courseEl.value.trim()||null,tee:teeEl.value.trim()||null,round_notes:notesRoundEl.value.trim()||null,holes}}
      function renderModel(data){dateEl.value=data.date||'';courseEl.value=data.course||'';teeEl.value=data.tee||'';notesRoundEl.value=data.round_notes||'';(data.holes||[]).forEach(h=>{document.querySelector(`#strokes-${h.hole}`).value=h.strokes??'';document.querySelector(`#putts-${h.hole}`).value=h.putts??'';document.querySelector(`#gir-${h.hole}`).checked=!!h.gir;document.querySelector(`#notes-${h.hole}`).value=h.notes??''});recalcTotals()}
      function recalcTotals(){const m=readModel();let tS=0,tP=0,tG=0;m.holes.forEach(h=>{if(typeof h.strokes==='number')tS+=h.strokes;if(typeof h.putts==='number')tP+=h.putts;if(h.gir)tG+=1});totalsEl.strokes.textContent=tS;totalsEl.putts.textContent=tP;totalsEl.gir.textContent=tG;return{tS,tP,tG}}
      function debouncedSave(){clearTimeout(saveTimer);autosaveStatus.textContent='Auto-save: pendingâ€¦';saveTimer=setTimeout(()=>{localStorage.setItem(LS_KEY,JSON.stringify(readModel()));autosaveStatus.textContent='Auto-save: saved';setTimeout(()=>autosaveStatus.textContent='Auto-save: idle',1500)},400)}
      function toJSON(){const model=readModel();const totals=recalcTotals();return JSON.stringify({...model,totals:{strokes:totals.tS,putts:totals.tP,gir:totals.tG}},null,2)}
      function download(filename,text){const blob=new Blob([text],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=filename;document.body.appendChild(a);a.click();a.remove();setTimeout(()=>URL.revokeObjectURL(url),1000)}
      document.addEventListener('input',e=>{if(e.target.matches('input,textarea')){recalcTotals();debouncedSave()}})
      exportBtn.addEventListener('click',()=>{const json=toJSON();jsonArea.value=json;const d=(dateEl.value||new Date().toISOString().slice(0,10));const cname=(courseEl.value||'round').replace(/\s+/g,'-').toLowerCase();download(`golf-round-${cname}-${d}.json`,json)})
      importBtn.addEventListener('click',()=>{try{const parsed=JSON.parse(jsonArea.value);if(!parsed||!Array.isArray(parsed.holes))throw new Error('Invalid structure');renderModel(parsed);localStorage.setItem(LS_KEY,JSON.stringify(parsed));autosaveStatus.textContent='Imported & saved';setTimeout(()=>autosaveStatus.textContent='Auto-save: idle',1500)}catch(err){alert('Could not import JSON: '+err.message)}})
      clearBtn.addEventListener('click',()=>{if(confirm('Clear all fields?')){localStorage.removeItem(LS_KEY);renderModel({holes:Array.from({length:18},(_,i)=>({hole:i+1}))});jsonArea.value=''}})
      const saved=localStorage.getItem(LS_KEY);if(saved){try{renderModel(JSON.parse(saved))}catch{}}else{dateEl.valueAsDate=new Date()}recalcTotals()
    })();
  </script>
</body>
</html>
